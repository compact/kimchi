<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: kimchi.utils.js</title>
    
    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">
    
    <h1 class="page-title">Source: kimchi.utils.js</h1>
    
    


    
    <section>
        <article>
            <pre class="prettyprint source"><code>/** @namespace Math */
/**
 * @param    {Number}  number         The number to round.
 * @param    {Number}  precision      The number of decimal places to round to.
 * @param    {Boolean} trailingZeroes Whether to include trailing zeroes.
 *                                    Defaults true.
 * @return   {Number}                 The rounded result..
 * @memberOf Math
 */
Math.roundDecimals = function (number, precision, trailingZeroes) {
	var multiplier, result;
	multiplier = Math.pow(10, precision);
	result = Math.round(number * multiplier) / multiplier;
	if (typeof trailingZeroes === 'boolean' && trailingZeroes) {
		result = result.toFixed(precision);
	}
	return result;
};
/**
 * Round the given number "nicely", as in determine the number of decimals
 *   based on the number of digits.
 * @param    {Number} number The number to round.
 * @return   {Number}        The rounded result.
 * @memberOf Math
 */
Math.roundNicely = function (number) {
	if (number &lt; 1) {
		return Math.roundDecimals(number, 2);
	} else if (number &lt; 10) {
		return Math.roundDecimals(number, 1);
	} else {
		return Math.round(number);
	}
};



/** @namespace Date */
/**
 * Month Strings for {@link Date.prototype.format}.
 * @memberOf Date
 */
Date.months = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep',
	'Oct', 'Nov', 'Dec'];
/**
 * @return   {String} Date custom formatted for the KIMCHI hud.
 * @memberOf Date
 */
Date.prototype.format = function () {
	return Date.months[this.getMonth()] + ' ' + this.getDate() + ', ' +
		this.getFullYear();
};



/**
 * Extensible module for KIMCHI. Extend like this:
 * &lt;br> var KIMCHI = (function (KIMCHI) {
 * &lt;br>   KIMCHI.foo = ...;
 * &lt;br>   return KIMCHI;
 * &lt;br> }(KIMCHI));
 * @module KIMCHI
 */
var KIMCHI = (function (KIMCHI, $, THREE) {
	'use strict';



	/**
	 * Functions for rendering and animating using the three.js renderer.
	 * @memberOf module:KIMCHI
	 */
	KIMCHI.rendering = {
		'render': function () {
			KIMCHI.renderer.render(KIMCHI.scene, KIMCHI.camera);
		},
		// callback is called before rendering. If it returns false, stop animating.
		'animate': function (callback) {
			setTimeout(function () { // TODO: remove for production
				var proceed = callback(KIMCHI.clock.getDelta());

				KIMCHI.rendering.render();

				// stop the next frame if the user has paused
				if (proceed !== false && KIMCHI.flight.mode !== false) {
					window.requestAnimationFrame(function () {
						KIMCHI.rendering.animate(callback);
					});
				}
			}, 50);
		}
	};



	/**
	 * Heads up display during free flight.
	 * @memberOf module:KIMCHI
	 */
	KIMCHI.hud = {};
	KIMCHI.hud.update = function (delta) {
		var translation = KIMCHI.controls.getLocalTranslationVector();
		$('#hud-distance-from-sun').text(Math.roundDecimals(KIMCHI.camera.position.length(), 2, true));
		$('#hud-speed').text(Math.roundDecimals((new THREE.Vector3(
			translation.x * KIMCHI.config.controls.strafeSpeed,
			translation.y * KIMCHI.config.controls.strafeSpeed,
			translation.z * KIMCHI.config.controls.zSpeed
		)).length() * KIMCHI.flight.getTranslationSpeedMultiplier(), 2, true));
		$('#hud-time').text(KIMCHI.date.format());

		if (KIMCHI.config.debug) {
			$('#hud4').html(
				'&lt;strong>Debug&lt;/strong>&lt;br />' +
				'Delta: ' +
					Math.roundDecimals(delta, 4, true) + '&lt;br />' +
				'Camera position (px): ' +
					Math.round(KIMCHI.camera.position.x) + ', ' +
					Math.round(KIMCHI.camera.position.y) + ', ' +
					Math.round(KIMCHI.camera.position.z) + '&lt;br />' +
				'Camera rotation (deg): ' +
					Math.round(KIMCHI.camera.rotation.x * 180 / Math.PI) + ', ' +
					Math.round(KIMCHI.camera.rotation.y * 180 / Math.PI) + ', ' +
					Math.round(KIMCHI.camera.rotation.z * 180 / Math.PI) + '&lt;br />'
/*			'movement: ' +
					translation.x + ', ' +
					translation.y + ', ' +
					translation.z + '&lt;br />' +*/
			);
		}
	};

	/**
	 * The navigation that appears when free flight is paused.
	 * @memberOf module:KIMCHI
	 */
	KIMCHI.nav = {};
	KIMCHI.nav.update = function () {
		KIMCHI.nav.updateFlyToList();
	};
	KIMCHI.nav.updateFlyToList = function () {
		var bodies = KIMCHI.space.getBodiesByDistance();
		$('#nav-fly-to').empty();
		_.forEach(bodies, function (body) {
			$('#nav-fly-to').append(
				$('&lt;li>').append(
					$('&lt;a>').text(body.name).data('name', body.name),
					$('&lt;span>').text(' (' + Math.roundNicely(body.distance) + ' AU)')
				)
			);
		});
	};



	/**
	 * Camera and renderer dimensions.
	 * @memberOf module:KIMCHI
	 */
	KIMCHI.size = {
		'width': 0,
		'height': 0,
		'init': function () {
			KIMCHI.size.update();
			KIMCHI.$window.on('resize', function () {
				KIMCHI.size.update();
				KIMCHI.rendering.animate(KIMCHI.flight.auto.animationFrame);
			});
		},
		'update': function () {
			KIMCHI.size.width = KIMCHI.$window.width();
			KIMCHI.size.height = KIMCHI.$window.height() - 5; // TODO
			KIMCHI.camera.update(KIMCHI.size.width, KIMCHI.size.height);
			KIMCHI.renderer.setSize(KIMCHI.size.width, KIMCHI.size.height);
		}
	};



	/**
	 * Notice box.
	 * @memberOf module:KIMCHI
	 */
	KIMCHI.notice = {
		'$notice': $(),
		'init': function () {
			KIMCHI.notice.$notice = $('#notice');
		},
		'set': function (message) {
			KIMCHI.notice.$notice.html(message).fadeIn();
		},
		'clear': function () {
			KIMCHI.notice.$notice.text('').fadeOut();
		}
	};



	return KIMCHI;
}(KIMCHI || {}, jQuery, THREE));</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Index</a></h2><h3>Modules</h3><ul><li><a href="module-KIMCHI.html">KIMCHI</a></li></ul><h3>Classes</h3><ul><li><a href="module-KIMCHI.space.Body.html">Body</a></li><li><a href="THREE.Controls.html">Controls</a></li><li><a href="THREE.Curve.html">Curve</a></li><li><a href="THREE.Matrix3.html">Matrix3</a></li><li><a href="THREE.Object3D.html">Object3D</a></li><li><a href="THREE.PerspectiveCamera.html">PerspectiveCamera</a></li><li><a href="THREE.Stars.html">Stars</a></li></ul><h3>Namespaces</h3><ul><li><a href="Date.html">Date</a></li><li><a href="Math.html">Math</a></li><li><a href="module-KIMCHI.config.html">config</a></li><li><a href="module-KIMCHI.flight.html">flight</a></li><li><a href="module-KIMCHI.pointerLock.html">pointerLock</a></li><li><a href="module-KIMCHI.space.html">space</a></li><li><a href="THREE.html">THREE</a></li></ul>
</nav>

<br clear="both">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.2.0-dev</a> on Fri Aug 30 2013 00:13:42 GMT-0400 (EDT)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
